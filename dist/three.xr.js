!function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.WebXRUtils=n.WebXRManager=void 0;var o=r(t(1)),s=r(t(2));n.WebXRManager=o.default,n.WebXRUtils=s.default},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),THREE.WebXRManager=function(e,n,t,r,o){this.renderer=n,this.camera=t,this.scene=r;var s=function(e){var n=this,t=(this.session.requestFrame(s),e.getViewPose(e.getCoordinateSystem(XRCoordinateSystem.HEAD_MODEL)));!1===l&&(l=!0,e.findFloorAnchor("first-floor-anchor").then(function(e){null!==e?n.addAnchoredNode(e,u):console.error("could not find the floor anchor")}).catch(function(e){console.error("error finding the floor anchor",e)}));var r=!0,i=!1,a=void 0;try{for(var c,h=d[Symbol.iterator]();!(r=(c=h.next()).done);r=!0){var f=c.value;this.updateNodeFromAnchorOffset(e,f.node,f.anchorOffset)}}catch(e){i=!0,a=e}finally{try{!r&&h.return&&h.return()}finally{if(i)throw a}}this.updateScene(o,e),this.renderer.autoClear=!1,this.renderer.setSize(this.session.baseLayer.framebufferWidth,this.session.baseLayer.framebufferHeight,!1),this.renderer.clear(),this.camera.matrixAutoUpdate=!1;var y=!0,p=!1,v=void 0;try{for(var g,m=e.views[Symbol.iterator]();!(y=(g=m.next()).done);y=!0){var b=g.value;this.camera.projectionMatrix.fromArray(b.projectionMatrix),this.camera.matrix.fromArray(t.poseModelMatrix),this.camera.updateMatrixWorld(!0),this.renderer.clearDepth();var R=b.getViewport(this.session.baseLayer);this.renderer.setViewport(R.x,R.y,R.width,R.height),this.doRender()}}catch(e){p=!0,v=e}finally{try{!y&&m.return&&m.return()}finally{if(p)throw v}}}.bind(this),i=e,a=null,l=!1,u=new THREE.Group,d=[];this.getDisplays=function(){return i},this.getDisplay=function(){return a},this.session=null,this.startSession=function(){var e=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={exclusive:n,type:n?XRSession.REALITY:XRSession.AUGMENTATION},o=!0,s=!1,l=void 0;try{for(var u,d=i[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var c=u.value;if(c.supportsSession(r)){a=c;break}}}catch(e){s=!0,l=e}finally{try{!o&&d.return&&d.return()}finally{if(s)throw l}}null!==a?setTimeout(function(){a.requestSession(r).then(function(n){e.session=n,e.session.depthNear=.1,e.session.depthFar=1e3,e.session.addEventListener("focus",function(n){e.handleSessionFocus(n)}),e.session.addEventListener("blur",function(n){e.handleSessionBlur(n)}),e.session.addEventListener("end",function(n){e.handleSessionEnded(n)}),t&&e.startPresenting()}).catch(function(e){console.error("Error requesting session",e)})},1e3):console.error("Could not find a display for this type of session")},this.handleSessionFocus=function(e){console.log("handleSessionFocus")},this.handleSessionBlur=function(e){console.log("handleSessionBlur")},this.handleSessionEnded=function(e){console.log("handleSessionEnded")},this.handleLayerFocus=function(e){console.log("handleLayerFocus")},this.handleLayerBlur=function(e){console.log("handleLayerBlur")},this.updateScene=function(e,n){e(n)},this.startPresenting=function(){var e=this;if(null===this.session)throw console.error("Can not start presenting without a session"),new Error("Can not start presenting without a session");this.session.baseLayer=new XRWebGLLayer(this.session,n.context),this.session.baseLayer.addEventListener("focus",function(n){e.handleLayerFocus(n)}),this.session.baseLayer.addEventListener("blur",function(n){e.handleLayerBlur(n)}),this.session.requestFrame(s)},this.doRender=function(){this.renderer.render(this.scene,this.camera)},this.addAnchoredNode=function(e,n){d.push({anchorOffset:e,node:n}),this.scene.add(n)},this.updateNodeFromAnchorOffset=function(e,n,t){var r=e.getAnchor(t.anchorUID);if(null!==r){n.matrixAutoUpdate=!1;var o=t.getTransformedCoordinates(r);o.coordinateSystem.type===XRCoordinateSystem.TRACKER?n.matrix.fromArray(o.poseMatrix):n.matrix.fromArray(o.getTransformedCoordinates(e.getCoordinateSystem(XRCoordinateSystem.TRACKER)).poseMatrix),n.updateMatrixWorld(!0)}else console.error("Unknown anchor uid",t.anchorUID)}},n.default=THREE.WebXRManager},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),THREE.WebXRUtils={getDisplays:function(){return new Promise(function(e,n){navigator.XR?navigator.XR.getDisplays().then(function(n){if(0==n.length)return console.log("No displays are available"),void e(null);e(n)}).catch(function(n){console.error("Error getting XR displays",n),e(null)}):e(null)})}},n.default=THREE.WebXRUtils}]);