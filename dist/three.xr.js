!function(e){function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var r={};n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,r){"use strict";r(1)},function(e,n,r){"use strict";THREE.WebXRManager=function(e,n,r){this.renderer=e,this.camera=n,this.scene=r;console.log("...");var t=function(e){var n=this,r=(this.session.requestFrame(t),e.getViewPose(e.getCoordinateSystem(XRCoordinateSystem.HEAD_MODEL)));!1===i&&(i=!0,e.findFloorAnchor("first-floor-anchor").then(function(e){null!==e?n.addAnchoredNode(e,a):console.error("could not find the floor anchor")}).catch(function(e){console.error("error finding the floor anchor",e)}));var o=!0,s=!1,d=void 0;try{for(var l,h=c[Symbol.iterator]();!(o=(l=h.next()).done);o=!0){var u=l.value;this.updateNodeFromAnchorOffset(e,u.node,u.anchorOffset)}}catch(e){s=!0,d=e}finally{try{!o&&h.return&&h.return()}finally{if(s)throw d}}this.updateScene(e),this.renderer.autoClear=!1,this.renderer.setSize(this.session.baseLayer.framebufferWidth,this.session.baseLayer.framebufferHeight,!1),this.renderer.clear(),this.camera.matrixAutoUpdate=!1;var f=!0,y=!1,p=void 0;try{for(var m,v=e.views[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;this.camera.projectionMatrix.fromArray(g.projectionMatrix),this.camera.matrix.fromArray(r.poseModelMatrix),this.camera.updateMatrixWorld(!0),this.renderer.clearDepth();var S=g.getViewport(this.session.baseLayer);this.renderer.setViewport(S.x,S.y,S.width,S.height),this.doRender()}}catch(e){y=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(y)throw p}}}.bind(this),o=null,s=null,i=!1,a=new THREE.Group,c=[];this.getDisplays=function(){return o},this.setDisplays=function(e){void 0!==e&&(o=e)},this.session=null,this.startSession=function(){var e=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t={exclusive:n,type:n?XRSession.REALITY:XRSession.AUGMENTATION},i=!0,a=!1,c=void 0;try{for(var d,l=o[Symbol.iterator]();!(i=(d=l.next()).done);i=!0){var h=d.value;if(h.supportsSession(t)){s=h;break}}}catch(e){a=!0,c=e}finally{try{!i&&l.return&&l.return()}finally{if(a)throw c}}null!==s?(console.log("---2",s),s.requestSession(t).then(function(n){e.session=n,e.session.depthNear=.1,e.session.depthFar=1e3,e.session.addEventListener("focus",function(n){e.handleSessionFocus(n)}),e.session.addEventListener("blur",function(n){e.handleSessionBlur(n)}),e.session.addEventListener("end",function(n){e.handleSessionEnded(n)}),r&&e.startPresenting()}).catch(function(e){console.error("Error requesting session",e)})):console.error("Could not find a display for this type of session")},this.handleSessionFocus=function(e){console.log("---handleSessionFocus")},this.handleSessionBlur=function(e){console.log("---handleSessionBlur")},this.handleSessionEnded=function(e){console.log("---handleSessionEnded")},this.handleLayerFocus=function(e){console.log("---handleLayerFocus")},this.handleLayerBlur=function(e){console.log("---handleLayerBlur")},this.updateScene=function(e){},this.startPresenting=function(){var n=this;if(console.log("--- start pressenting"),null===this.session)throw console.error("Can not start presenting without a session"),new Error("Can not start presenting without a session");this.session.baseLayer=new XRWebGLLayer(this.session,e.context),this.session.baseLayer.addEventListener("focus",function(e){n.handleLayerFocus(e)}),this.session.baseLayer.addEventListener("blur",function(e){n.handleLayerBlur(e)}),this.session.requestFrame(t)},this.doRender=function(){this.renderer.render(this.scene,this.camera)},this.addAnchoredNode=function(e,n){c.push({anchorOffset:e,node:n}),this.scene.add(n)},this.updateNodeFromAnchorOffset=function(e,n,r){var t=e.getAnchor(r.anchorUID);if(null!==t){n.matrixAutoUpdate=!1;var o=r.getTransformedCoordinates(t);o.coordinateSystem.type===XRCoordinateSystem.TRACKER?n.matrix.fromArray(o.poseMatrix):n.matrix.fromArray(o.getTransformedCoordinates(e.getCoordinateSystem(XRCoordinateSystem.TRACKER)).poseMatrix),n.updateMatrixWorld(!0)}else console.error("Unknown anchor uid",r.anchorUID)}}}]);